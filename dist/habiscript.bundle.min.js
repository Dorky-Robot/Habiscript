!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Habiscript=t()}(this,(function(){"use strict";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t={exports:{}},n={exports:{}};!function(e,t){e.exports=function(){function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e){return a(e)?e:c(r({stylesObject:e}))}const n="__*__";function r({stylesObject:e,parentSelector:t="",cssObject:i={},nestedSelector:c=""}){if(Array.isArray(e)){const[r,o]=e,a=`${s(r)}:${o};`,l=c?i[c]=i[c]||{}:i,f=s(t||n);l[f]=(l[f]||"")+a}else Object.keys(e).forEach((a=>{const l=e[a];if(a.startsWith("@"))r({stylesObject:l,cssObject:i,nestedSelector:a});else if("object"!=typeof l){const e=`${s(a)}:${l};`,r=c?i[c]=i[c]||{}:i,o=s(t||n);r[o]=(r[o]||"")+e}else r({stylesObject:l,parentSelector:o(t,a),cssObject:i,nestedSelector:c})}));return i}function o(e,t){if(!e)return t;const n=i(e),r=i(t);return n.map((e=>r.map((t=>`${e}${t.startsWith(":")?"":" "}${t}`)).join(","))).join(",")}function s(e){return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}function i(e){return e.split(",").map((e=>e.trim()))}function c(e){return"object"!=typeof e||Array.isArray(e)||a(e)?e:Object.entries(e).map((([e,t])=>e===n?c(t):`${e}{${c(t)}}`)).join("")}function a(e){return!e||0===Object.keys(e).length}var l=e({style:t});return l}()}(n);var r=n.exports;return function(e){const{style:t}=r,n=/\.[^.#]+/g,o=/#[^.#]+/;function s(e){let t={};return e.split(";").forEach((e=>{let[n,r]=e.split(":");n&&r&&(n=n.trim(),n=n.replace(/-./g,(e=>e.charAt(1).toUpperCase())),t[n]=r.trim())})),t}function i(e){if("string"==typeof e)return document.createTextNode(e);if(e instanceof Node)return e;const[t,...r]=e;let s,c={};if("string"!=typeof t)throw new Error("The first element of the habiscript array must be a string.");{s=t.split(/[#.]/)[0];const e=t.match(n),r=t.match(o);e&&(c.class=e.map((e=>e.substring(1))).join(" ")),r&&(c.id=r[0].substring(1))}r.length>0&&"object"==typeof r[0]&&!Array.isArray(r[0])&&Object.assign(c,r.shift());return function(e,t={},n){const r=document.createElement(e);for(const[e,n]of Object.entries(t))if("style"===e&&"object"==typeof n)Object.assign(r.style,n);else if("function"==typeof n&&e.startsWith("on")){const t=e.substring(2).toLowerCase();r.addEventListener(t,n)}else void 0!==n&&r.setAttribute(e,n);for(const e of n)"string"==typeof e?r.appendChild(document.createTextNode(e)):e instanceof Node?r.appendChild(e):Array.isArray(e)&&r.appendChild(i(e));return r}(s,c,r.flatMap((e=>Array.isArray(e)?i(e):e)))}function c(e,t){let n="string"==typeof e?e:null,r=Array.isArray(e)?e:t;if(!r||n&&!t)throw new Error("Invalid arguments. Expected a selector string and Habiscript array, or just a Habiscript array.");const o=i(r);return n?function(e,t){return"loading"===document.readyState?new Promise((n=>{document.addEventListener("DOMContentLoaded",(()=>{a(e,t),n(t)}))})):(a(e,t),t)}(n,o):function(e){const t=document.currentScript;t&&t.parentNode?t.parentNode.insertBefore(e,t.nextSibling):console.warn("Unable to determine script location. Element created but not inserted.");return e}(o)}function a(e,t){const n=document.querySelector(e);n?n.appendChild(t):console.warn(`Target element with selector "${e}" not found.`)}c.habiToHtml=i,c.htmlToHabi=function e(t){if("string"==typeof t){return e((new DOMParser).parseFromString(t,"text/html").body.firstChild)}if(t.nodeType===Node.TEXT_NODE)return t.textContent;let n=t.tagName.toLowerCase();t.id&&(n+=`#${t.id}`),t.className&&(n+=`.${t.className.split(" ").join(".")}`);const r=[n],o={};for(const e of t.attributes)"class"!==e.name&&"id"!==e.name&&("style"===e.name?o.style=s(e.value):o[e.name]=e.value);Object.keys(o).length>0&&r.push(o);for(const n of t.childNodes)r.push(e(n));return r},c.toElement=function(e){return i(e)},c.style=function(e){return this.toElement(["style",t(e)])},e.exports?e.exports=c:"undefined"!=typeof window&&(window.Habiscript=c)}(t),e(t.exports)}));
